[gd_scene load_steps=14 format=3 uid="uid://it1n1qhtj542"]

[ext_resource type="PackedScene" uid="uid://buiprln41cfpx" path="res://prefabs/player.tscn" id="1_43qf2"]
[ext_resource type="Script" path="res://scripts/player.gd" id="2_mt1bp"]
[ext_resource type="PackedScene" uid="uid://co2m4q67sc6ft" path="res://prefabs/Background.tscn" id="3_we4tt"]
[ext_resource type="PackedScene" uid="uid://bxqsfykh2dtrj" path="res://prefabs/HungerBar.tscn" id="4_j1ccm"]
[ext_resource type="Texture2D" uid="uid://ct21es41qppfq" path="res://Textures/DirtHole2.png" id="5_4kk5j"]
[ext_resource type="Script" path="res://scripts/spawner.gd" id="6_wp5ee"]
[ext_resource type="PackedScene" uid="uid://dvdojj50hfjq" path="res://prefabs/food.tscn" id="7_43g7p"]
[ext_resource type="PackedScene" uid="uid://cp5bfettkcvbv" path="res://scenes/death_screen.tscn" id="8_h5is4"]
[ext_resource type="Script" path="res://scripts/score.gd" id="9_ctfq8"]
[ext_resource type="PackedScene" uid="uid://chvr0uow3x2x3" path="res://scenes/tunnel.tscn" id="10_r0m1m"]
[ext_resource type="PackedScene" uid="uid://dpm0guu7awebg" path="res://scenes/pause_menu.tscn" id="11_laf22"]

[sub_resource type="GDScript" id="GDScript_uyv7r"]
script/source = "extends Node2D

@export var food_scene: PackedScene
@export var spawn_radius: float = 200.0
@export var spawn_interval: float = 2.0

@onready var player = get_tree().get_first_node_in_group(\"Player\")

func _ready():
	if not food_scene:
		print(\"⚠️ No Food scene assigned in Inspector!\")
		return

	# spawn one immediately to test
	spawn_food()

	# spawn repeatedly
	var t = Timer.new()
	t.wait_time = spawn_interval
	t.autostart = true
	t.timeout.connect(spawn_food)
	add_child(t)

func spawn_food():
	var food = food_scene.instantiate()
	add_child(food)

	# Pick a random angle around the player
	var angle = randf() * TAU
	var offset = Vector2(cos(angle), sin(angle)) * spawn_radius
	food.global_position = player.global_position + offset

	# Give the food a reference to the player
	food.player = player

	print(\"✅ Spawned food at \", food.global_position)
"

[sub_resource type="LabelSettings" id="LabelSettings_nales"]
font_size = 50
outline_size = 10
outline_color = Color(0, 0, 0, 1)

[node name="game" type="Node2D"]
script = SubResource("GDScript_uyv7r")

[node name="player" parent="." groups=["Player"] instance=ExtResource("1_43qf2")]
position = Vector2(576, 648)
script = ExtResource("2_mt1bp")

[node name="Background" parent="." instance=ExtResource("3_we4tt")]

[node name="HungerBar" parent="." instance=ExtResource("4_j1ccm")]

[node name="SpawnHole" type="Sprite2D" parent="."]
show_behind_parent = true
position = Vector2(576, 648)
scale = Vector2(1.5, 1.5)
texture = ExtResource("5_4kk5j")

[node name="Spawner" type="Node2D" parent="."]
script = ExtResource("6_wp5ee")
food_scene = ExtResource("7_43g7p")

[node name="DeathScreen" parent="." instance=ExtResource("8_h5is4")]
visible = false

[node name="Score" type="CanvasLayer" parent="."]
layer = 2
script = ExtResource("9_ctfq8")

[node name="Label" type="Label" parent="Score"]
offset_left = 20.0
offset_right = 276.0
offset_bottom = 80.0
text = "Score: 0"
label_settings = SubResource("LabelSettings_nales")
vertical_alignment = 1

[node name="Tunnel" parent="." instance=ExtResource("10_r0m1m")]

[node name="PauseMenu" parent="." instance=ExtResource("11_laf22")]
visible = false
